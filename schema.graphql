enum JobStatus {
  Filled
  Confirmed
  Rejected
  Finished
  Opened
}

enum PaymentType {
  Release
  Reimburse
}

type Job @entity {
  id: ID! # job token id
  createdAt: BigInt # timestamp of block creation
  updatedAt: BigInt # timestamp of the last change
  status: JobStatus! # job status
  buyer: User # job buyer
  seller: User # job seller
  sender: User # user that created the job (buyer or seller)
  recipient: User # other participating user (seller or buyer)
  uri: String # metadata URI of job
  transactionId: String # Escrow transaction id of job
  proposals: [Proposal!] @derivedFrom(field: "job") # proposals for this job
  platformId: ID! # Platform Id on which job token was minted
}

type Review @entity {
  id: ID! # review token id
  job: Job! # job this review is for
  to: User! # reviewed user
  uri: String! # metadata URI of review
  platformId: ID! # Platform Id on which review token was minted
}

type User @entity {
  id: ID! # user token id
  platformId: ID! # Platform Id on which user token was minted
  address: String! # wallet address of user
  uri: String! # metadata URI of profile
  handle: String! # handle of user
  withPoh: Boolean! # whether user has proof of identity
  numReviews: BigInt! # number of reviews user has received
  rating: BigDecimal! # average rating from reviews user has received
  reviews: [Review!] @derivedFrom(field: "to") # reviews of user
  buyerJobs: [Job!] @derivedFrom(field: "buyer") # jobs user is an buyer for
  sellerJobs: [Job!] @derivedFrom(field: "seller") # jobs user is an seller for
}

enum ProposalStatus {
  Pending
  Validated
  Rejected
}

type Proposal @entity {
  id: ID! # concatenation of jobId + seller TalentLayerId
  job: Job! # job entity
  createdAt: BigInt # timestamp of block creation
  updatedAt: BigInt # timestamp of the last change
  status: ProposalStatus! # Proposal status
  seller: User # Proposal seller
  rateToken: Bytes # Rate token
  rateAmount: BigInt # Rate amount
  uri: String! # metadata URI of job
}

#NB: Payment sender will always be the Escrow Contract
type Payment @entity {
  id: ID! # autogenerated id
  job: Job! # job entity
  amount: BigInt # payment amount
  rateToken: Bytes # Rate token
  paymentType: String # Whether the payment is a release or a reimbursement
  transactionHash: String # Transaction hash of the transfer
}

type Platform @entity {
  id: ID! # platform id
  createdAt: BigInt # timestamp of block creation
  address: Bytes! # wallet address of platform owner
  name: String! # name of the platform
  uri: String # metadata URI of platform
}
